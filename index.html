
const sheetName = 'Sheet1';

function doPost(e) {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName);
  const data = JSON.parse(e.postData.contents);
  sheet.appendRow([new Date(), data.name, data.message, data.image || '', data.video || '']);
  return ContentService.createTextOutput("OK").setMimeType(ContentService.MimeType.TEXT);
}
<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ø±Ú©ÙˆØ±Ø¯ Ø¯ÙˆÚ†Ø±Ø®Ù‡â€ŒØ³ÙˆØ§Ø±ÛŒ Ù…Ù†</title>
  <style>
    body {
      font-family: Tahoma, sans-serif;
      background: #f9f9f9;
      margin: 0;
      padding: 0;
      direction: rtl;
      transition: direction 0.3s;
    }
    header {
      background: #4CAF50;
      color: white;
      padding: 1rem;
      text-align: center;
    }
    nav {
      background: #eee;
      padding: 1rem;
      display: flex;
      justify-content: center;
      gap: 1rem;
      flex-wrap: wrap;
    }
    nav button {
      padding: 0.5rem 1rem;
      cursor: pointer;
    }
    section {
      padding: 2rem;
    }
    label {
      display: block;
      margin-top: 1rem;
    }
    input, textarea {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.25rem;
    }
    .comment {
      background: #fff;
      border: 1px solid #ccc;
      margin-top: 1rem;
      padding: 1rem;
      border-radius: 5px;
    }
    .lang-toggle {
      float: left;
      margin-top: -3rem;
      margin-left: 1rem;
    }
  </style>
</head>
<body>
  <header>
    <h1 id="site-title">Ø±Ú©ÙˆØ±Ø¯ Ø¯ÙˆÚ†Ø±Ø®Ù‡â€ŒØ³ÙˆØ§Ø±ÛŒ Ù…Ù†</h1>
    <div class="lang-toggle">
      <button onclick="toggleLang()">ğŸŒ ÙØ§Ø±Ø³ÛŒ / English</button>
    </div>
  </header>

  <nav>
    <button onclick="scrollToSection('about')">ğŸ Ù…Ø¹Ø±ÙÛŒ</button>
    <button onclick="scrollToSection('form')">ğŸ“ Ø«Ø¨Øª Ù†Ø¸Ø±</button>
    <button onclick="scrollToSection('comments')">ğŸ’¬ Ù†Ø¸Ø±Ø§Øª</button>
    <button onclick="scrollToSection('contact')">ğŸ“ ØªÙ…Ø§Ø³</button>
  </nav>

  <section id="about">
    <h2 id="about-title">Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ø±Ú©ÙˆØ±Ø¯</h2>
    <p id="about-text">
      Ù…Ù† Ø¯Ø± ØªÙ„Ø§Ø´ Ù‡Ø³ØªÙ… Ø±Ú©ÙˆØ±Ø¯ÛŒ Ø¯Ø± Ø²Ù…ÛŒÙ†Ù‡ Ø¯ÙˆÚ†Ø±Ø®Ù‡â€ŒØ³ÙˆØ§Ø±ÛŒ Ø¨Ù‡ Ø«Ø¨Øª Ø¨Ø±Ø³Ø§Ù†Ù…. Ø§ÛŒÙ† Ø³Ø§ÛŒØª Ø¨Ø±Ø§ÛŒ Ù…Ø¹Ø±ÙÛŒ Ø§ÛŒÙ† Ø±Ú©ÙˆØ±Ø¯ Ùˆ Ø¬Ø°Ø¨ Ø­Ù…Ø§ÛŒØª Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯Ù‡ Ø§Ø³Øª.
    </p>
  </section>

  <section id="form">
    <h2 id="form-title">Ø«Ø¨Øª Ù†Ø¸Ø±</h2>
    <form id="commentForm">
      <label id="name-label">Ù†Ø§Ù…:</label>
      <input type="text" name="name" required>

      <label id="message-label">Ù¾ÛŒØ§Ù…:</label>
      <textarea name="message" required></textarea>

      <label id="image-label">Ù„ÛŒÙ†Ú© ØªØµÙˆÛŒØ± (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
      <input type="url" name="image">

      <label id="video-label">Ù„ÛŒÙ†Ú© ÙˆÛŒØ¯ÛŒÙˆ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
      <input type="url" name="video">

      <button type="submit" style="margin-top:1rem;">Ø§Ø±Ø³Ø§Ù„</button>
    </form>
  </section>

  <section id="comments">
    <h2 id="comments-title">Ù†Ø¸Ø±Ø§Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</h2>
    <div id="commentList">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ø¸Ø±Ø§Øª...</div>
  </section>

  <section id="contact">
    <h2 id="contact-title">ØªÙ…Ø§Ø³ Ø¨Ø§ Ù…Ù†</h2>
    <p><strong>ğŸ“§ Ø§ÛŒÙ…ÛŒÙ„:</strong> <a href="mailto:m1961r1340632@gmail.com">m1961r1340632@gmail.com</a></p>
    <p><strong>ğŸ“ Ø´Ù…Ø§Ø±Ù‡:</strong> <a href="tel:+989121831998">+989121831998</a></p>
  </section>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbz0rL7bS7xXjZBEqQuKS_Y2sqdCUt78NHNGzVI5xoWzd3Uc-uxHsoCvhdMQx3Whvte7/exec";
    const form = document.getElementById("commentForm");
    const commentList = document.getElementById("commentList");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const data = Object.fromEntries(new FormData(form).entries());
      await fetch(scriptURL, {
        method: "POST",
        body: JSON.stringify(data),
      });
      form.reset();
      loadComments();
    });

    async function loadComments() {
      commentList.innerHTML = "Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...";
      const res = await fetch(scriptURL);
      const comments = await res.json();
      commentList.innerHTML = "";
      comments.reverse().forEach(c => {
        const div = document.createElement("div");
        div.className = "comment";
        div.innerHTML = `
          <strong>${c.name}</strong><br/>
          <p>${c.message}</p>
          ${c.image ? <img src="${c.image}" width="200"/> : ""}
          ${c.video ? <video src="${c.video}" width="200" controls></video> : ""}
        `;
        commentList.appendChild(div);
      });
    }

    loadComments();

    function scrollToSection(id) {
      document.getElementById(id).scrollIntoView({ behavior: "smooth" });
    }

    // Ø²Ø¨Ø§Ù†â€ŒÙ‡Ø§
    let currentLang = "fa";
    const translations = {
      fa: {
        "site-title": "Ø±Ú©ÙˆØ±Ø¯ Ø¯ÙˆÚ†Ø±Ø®Ù‡â€ŒØ³ÙˆØ§Ø±ÛŒ Ù…Ù†",
        "about-title": "Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ø±Ú©ÙˆØ±Ø¯",
        "about-text": "Ù…Ù† Ø¯Ø± ØªÙ„Ø§Ø´ Ù‡Ø³ØªÙ… Ø±Ú©ÙˆØ±Ø¯ÛŒ Ø¯Ø± Ø²Ù…ÛŒÙ†Ù‡ Ø¯ÙˆÚ†Ø±Ø®Ù‡â€ŒØ³ÙˆØ§Ø±ÛŒ Ø¨Ù‡ Ø«Ø¨Øª Ø¨Ø±Ø³Ø§Ù†Ù…...",
        "form-title": "Ø«Ø¨Øª Ù†Ø¸Ø±",
        "name-label": "Ù†Ø§Ù…:",
        "message-label": "Ù¾ÛŒØ§Ù…:",
        "image-label": "Ù„ÛŒÙ†Ú© ØªØµÙˆÛŒØ± (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):",
        "video-label": "Ù„ÛŒÙ†Ú© ÙˆÛŒØ¯ÛŒÙˆ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):",
        "comments-title": "Ù†Ø¸Ø±Ø§Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†",
        "contact-title": "ØªÙ…Ø§Ø³ Ø¨Ø§ Ù…Ù†"
      },
      en: {
        "site-title": "My Cycling Record",
        "about-title": "About the Record",
        "about-text": "I'm trying to set a new cycling record. This site is created to introduce the effort and get support.",
        "form-title": "Submit a Comment",
        "name-label": "Name:",
        "message-label": "Message:",
        "image-label": "Image URL (optional):",
        "video-label": "Video URL (optional):",
        "comments-title": "User Comments",
        "contact-title": "Contact Me"
      }
    };

    function toggleLang() {
      currentLang = currentLang === "fa" ? "en" : "fa";
      document.documentElement.lang = currentLang;
      document.body.dir = currentLang === "fa" ? "rtl" : "ltr";
      const t = translations[currentLang];
      for (let id in t) {
        const el = document.getElementById(id);
        if (el) el.innerText = t[id];
      }
    }
  </script>
</body>
</html>

